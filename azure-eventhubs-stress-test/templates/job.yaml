{{- include "stress-test-addons.env-job-template.from-pod" (list . "stress.event-hubs") -}}
{{- define "stress.event-hubs" -}}
metadata:
  labels:
    testName: "eventhub-{{ .Release.Name }}-{{ .Release.Revision }}"
spec:
  containers:
    - name: java-event-hubs-send
      image: {{ .Values.image }}
      imagePullPolicy: Always
      args: [ "--TEST_CLASS=SendSimpleEvent" ]
      env:
        - name: EVENT_HUBS_CONNECTION_STRING
          valueFrom:
            secretKeyRef:
              key: EVENT_HUBS_CONNECTION_STRING
              name: event-hubs-secret
        - name: EVENT_HUB_NAME
          value: eventhub-test
{{- end -}}